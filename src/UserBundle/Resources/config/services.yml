services:

     # ------ Image --------------------------------------------------------------------------------------------------- #
    agent_system.image_repository:
        class: UserBundle\Business\Repository\ImageRepository
        factory: ["@doctrine.orm.default_entity_manager", getRepository]
        arguments:
            - UserBundle\Entity\Document\Image

    agent_system.image_manager:
       class: UserBundle\Business\Manager\ImageManager
       arguments:
             repository: "@agent_system.image_repository"

    agent_system.image.adapter:
        class: UserBundle\Adapter\Image\ImageAdapter
        arguments:
            - "@agent_system.image_manager"
        tags:
            - { name: request.param_converter, converter:attribute priority: 10 }

 # ------ Address --------------------------------------------------------------------------------------------------- #
    agent_system.address_repository:
        class: UserBundle\Business\Repository\AddressRepository
        factory: ["@doctrine.orm.default_entity_manager", getRepository]
        arguments:
            - UserBundle\Entity\Address

    agent_system.address_manager:
       class: UserBundle\Business\Manager\AddressManager
       arguments:
             repository: "@agent_system.address_repository"

    agent_system.address.adapter:
        class: UserBundle\Adapter\Address\AddressAdapter
        arguments:
            - "@agent_system.address_manager"
        tags:
            - { name: request.param_converter, converter:attribute priority: 10 }


    # ------ Group --------------------------------------------------------------------------------------------------- #
    agent_system.group.repository:
        class: UserBundle\Business\Repository\GroupRepository
        factory: ["@doctrine.orm.default_entity_manager", getRepository]
        arguments:
            - UserBundle\Entity\Group

    agent_system.group.manager:
        class: UserBundle\Business\Manager\GroupManager
        arguments:
            repository: "@agent_system.group.repository"
#            container: "@alligator.group.container"

    agent_system.group.adapter:
        class: UserBundle\Adapter\Group\GroupAdapter
        arguments:
            - "@agent_system.group.manager"
        tags:
            - { name: request.param_converter, converter:attribute priority: 10 }

    # ------ Role ---------------------------------------------------------------------------------------------------- #
    agent_system.role.repository:
        class: UserBundle\Business\Repository\RoleRepository
        factory: ["@doctrine.orm.default_entity_manager", getRepository]
        arguments:
            - UserBundle\Entity\Role

    agent_system.role.manager:
        class: UserBundle\Business\Manager\RoleManager
        arguments:
            repository: "@agent_system.role.repository"

    agent_system.role.adapter:
        class: UserBundle\Adapter\Role\RoleAdapter
        arguments:
            - "@agent_system.role.manager"
        tags:
            - { name: request.param_converter, converter:attribute priority: 10 }

    fos_oauth_server.controller.token:
            class: UserBundle\Controller\TokenController
            arguments: ['@fos_oauth_server.server', '@doctrine.orm.entity_manager']

    # ------ TCR User ------------------------------------------------------------------------------------------------ #
    agent_system.tcr_user_manager:
        class: UserBundle\Business\Manager\TCRUserManager


    # ------ Agent --------------------------------------------------------------------------------------------------- #
    agent_system.agent.repository:
        class: UserBundle\Business\Repository\AgentRepository
        factory: ["@doctrine.orm.default_entity_manager", getRepository]
        arguments:
            - UserBundle\Entity\Agent

    agent_system.agent.manager:
        class: UserBundle\Business\Manager\AgentManager
        arguments:
            repository: "@agent_system.agent.repository"
            roleManager: "@agent_system.group.manager"
            syncManager: "@agent_system.tcr_user_manager"

    agent_system.agent.adapter:
        class: UserBundle\Adapter\Agent\AgentAdapter
        arguments:
            - "@agent_system.agent.manager"
        tags:
            - { name: request.param_converter, converter:attribute priority: 10 }